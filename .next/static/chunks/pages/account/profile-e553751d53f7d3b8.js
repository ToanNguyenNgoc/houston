(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[771],{97971:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/profile",function(){return l(16822)}])},37079:function(e,a,l){"use strict";l.d(a,{D:function(){return o},z:function(){return r}});var i=l(67294);function o(){let[e,a]=(0,i.useState)({load:!1,message:"",openAlert:!1,color:"info"}),l=()=>a({...e,load:!0}),o=e=>{var l;a({load:!1,message:null!==(l=e.message)&&void 0!==l?l:"",openAlert:!0,element:e.element,color:e.color})},n=()=>a({...e,openAlert:!1});return{noti:e,firstLoad:l,resultLoad:o,onCloseNoti:n}}var n=l(71697);function r(){let[e,a]=(0,i.useState)([]),l=async e=>{let{e:l,callBack:i}=e;if(l.target.files)try{var o;let e=[];for(var r=0;r<(null===(o=l.target.files)||void 0===o?void 0:o.length);r++){let a=l.target.files[r],i=new FormData,o={original_url:"",mediaId:r};i.append("file",a);let c=await n.h.uploadMedia(i);c&&(o={original_url:c.data.original_url,mediaId:c.data.id}),e.push(o)}a(e),i&&i(e)}catch(e){}};return{medias:e,handlePostMedia:l}}},29684:function(e,a,l){"use strict";l.r(a),l.d(a,{PageHeaderAccount:function(){return g}});var i=l(85893),o=l(85701),n=l(14833),r=l(71697),c=l(26394),t=l.n(c),s=l(59403),_=l(89583),d=l(30381),m=l.n(d),u=l(41664),h=l.n(u),v=l(64074),x=l(8987),p=l(11163);let g=e=>{let{title:a}=e,l=(0,p.useRouter)();return(0,i.jsxs)("div",{className:t().account_page_title,children:[(0,i.jsx)("button",{onClick:()=>l.back(),className:t().account_page_title_btn,children:(0,i.jsx)(_._HU,{size:26,color:"var(--primary)"})}),(0,i.jsx)("span",{children:a})]})},f=()=>{var e,a,l,n;let{data:c,fetchNextPage:d,isLoading:u,isFetchingNextPage:p}=(0,s.N)({queryKey:["BOOKINGS"],queryFn:e=>{let{pageParam:a=1}=e;return r.h.bookings({page:a,limit:10,includes:"full_address|villa_media"})},getNextPageParam:e=>e.current_page+1}),f=null!==(l=null===(e=null==c?void 0:c.pages[0])||void 0===e?void 0:e.total)&&void 0!==l?l:0,b=null!==(n=null==c?void 0:null===(a=c.pages)||void 0===a?void 0:a.map(e=>e.data).flat())&&void 0!==n?n:[];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.pQ,{title:"Lịch sử đặt ph\xf2ng",description:"",url:""}),(0,i.jsx)(g,{title:"Lịch sử đặt ph\xf2ng"}),(0,i.jsxs)("div",{className:t().account_page_body,children:[(0,i.jsx)("ul",{className:t().booking_list,children:b.map(e=>{var a,l,o,n,r,c,s,d,u,x;return(0,i.jsx)("li",{className:t().booking_list_item,children:(0,i.jsxs)(h(),{href:"/",className:t().booking_item,children:[(0,i.jsx)("div",{className:t().booking_item_img,children:(0,i.jsx)("img",{src:null===(a=e.villa)||void 0===a?void 0:null===(l=a.thumbnail)||void 0===l?void 0:l.original_url,alt:""})}),(0,i.jsxs)("div",{className:t().booking_item_detail,children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:t().booking_item_detail_head_create,children:["ng\xe0y đặt: ",m()(e.created_at).format("HH:mm DD [thg] MM, YYYY")]}),(0,i.jsxs)("div",{className:t().booking_item_detail_head,children:[(0,i.jsx)("span",{children:null===(o=e.villa)||void 0===o?void 0:o.name}),(0,i.jsxs)("span",{children:["Trạng th\xe1i đặt ",(0,i.jsx)("br",{}),e.status_booking]})]}),(0,i.jsxs)("span",{className:t().booking_item_detail_address,children:[(0,i.jsx)(_.Nh4,{color:"var(--primary)",size:12}),null===(n=e.branch)||void 0===n?void 0:n.address,",",null===(r=e.branch)||void 0===r?void 0:null===(c=r.ward)||void 0===c?void 0:c.name,",",null===(s=e.branch)||void 0===s?void 0:null===(d=s.district)||void 0===d?void 0:d.name,",",null===(u=e.branch)||void 0===u?void 0:null===(x=u.province)||void 0===x?void 0:x.name]}),(0,i.jsxs)("div",{className:t().range_date,children:[(0,i.jsxs)("div",{className:t().range_date_item,children:[(0,i.jsx)("p",{children:"Nhận ph\xf2ng"}),(0,i.jsx)("p",{children:m()(e.from_date_booking).format("DD [thg] MM, YYYY")})]}),(0,i.jsxs)("div",{className:t().range_date_item,children:[(0,i.jsx)("p",{children:"Trả ph\xf2ng"}),(0,i.jsx)("p",{children:m()(e.to_date_booking).format("DD [thg] MM, YYYY")})]})]})]}),(0,i.jsxs)("div",{className:t().booking_item_detail_amount,children:[(0,i.jsx)("span",{children:"Tổng cộng"}),(0,i.jsxs)("span",{children:[(0,v.BX)(e.amount)," / (",e.nights," đ\xeam)"]})]})]})]})},e.id)})}),(0,i.jsx)("div",{className:t().account_page_bot,children:b.length<f&&(0,i.jsx)(x.Z,{loading:p,onClick:()=>d(),style:{color:"var(--primary)"},children:"Xem th\xeam"})})]})]})};f.Layout=n.p0,a.default=f},16822:function(e,a,l){"use strict";l.r(a);var i=l(85893),o=l(85701),n=l(14833),r=l(29684),c=l(71697),t=l(66838),s=l(26394),_=l.n(s),d=l(8987),m=l(72890),u=l(50480),h=l(77781),v=l(61041),x=l(48228),p=l(67294),g=l(87536),f=l(30381),b=l.n(f),j=l(74231),N=l(64074),w=l(47533),k=l(37079);let y=j.Ry({fullname:j.Z_().required("Vui l\xf2ng nhập họ v\xe0 t\xean"),telephone:j.Z_().required("Vui l\xf2ng nhập số điện thoại").matches(N.Gu.phoneVn,{message:"Vui l\xf2ng nhập đ\xfang ddijng dạng"}),full_address:j.Z_().required("Vui l\xf2ng nhập địa chỉ")}),D=()=>{let[e]=(0,t.O)(e=>[e.isLoading]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.pQ,{title:"T\xe0i khoản của t\xf4i",description:"",url:""}),(0,i.jsx)(r.PageHeaderAccount,{title:"T\xe0i khoản của t\xf4i"}),(0,i.jsx)("div",{className:_().account_page_body,children:!e&&(0,i.jsx)(Y,{})})]})};D.Layout=n.p0,a.default=D;let Y=()=>{var e,a,l,n;let[r,s]=(0,t.O)(e=>[e.profile,e.putProfile]),{resultLoad:f,noti:{openAlert:j,message:N,color:D},onCloseNoti:Y}=(0,k.D)(),{handlePostMedia:C}=(0,k.z)(),[M,Z]=(0,p.useState)(null==r?void 0:r.sex),[F,P]=(0,p.useState)((null==r?void 0:r.dob)?new Date(r.dob):new Date),{register:E,handleSubmit:S,formState:{errors:T}}=(0,g.cI)({resolver:(0,w.X)(y),defaultValues:{fullname:null==r?void 0:r.fullname,email:null==r?void 0:r.email,telephone:null==r?void 0:r.telephone,ccid:null==r?void 0:r.ccid,full_address:null==r?void 0:r.full_address}}),{mutate:A,isLoading:I}=(0,x.D)({mutationKey:["PUT_PROFILE"],mutationFn:e=>c.h.putProfile(e),onSuccess:e=>{s(e.data),f({message:"Đ\xe3 thay đổi th\xf4ng tin c\xe1 nh\xe2n",color:"success"})},onError:()=>{f({color:"error",message:"C\xf3 lỗi xảy ra"})}}),L=e=>{A({...e,telephone:e.telephone!==(null==r?void 0:r.telephone)?e.telephone:void 0,sex:M,dob:b()(F).format("YYYY-MM-DD")})},q=async e=>{C({e,callBack:e=>{A({media_id:e[0].mediaId})}})},H=e=>{let a=!1;"true"===e.target.value&&(a=!0),Z(a)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Ct,{open:j,message:N,severity:D,close:Y}),(0,i.jsxs)("form",{onSubmit:S(L),children:[(0,i.jsxs)("div",{className:"".concat(_().acc_form_row," ").concat(_().row_avatar),children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"Avatar"}),(0,i.jsxs)("div",{className:_().form_avatar,children:[(0,i.jsx)("img",{src:null==r?void 0:null===(e=r.avatar)||void 0===e?void 0:e.original_url,alt:""}),(0,i.jsx)(o.Zy,{onChange:q,className:_().form_avatar_btn,iconColor:"var(--white)"})]})]}),(0,i.jsxs)("div",{className:_().acc_form_row,children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"Họ & t\xean"}),(0,i.jsxs)("div",{className:_().acc_form_row_ip,children:[(0,i.jsx)("input",{...E("fullname"),type:"text",className:"app-input"}),(0,i.jsx)("span",{className:_().acc_form_row_ip_error,children:null==T?void 0:null===(a=T.fullname)||void 0===a?void 0:a.message})]})]}),(0,i.jsxs)("div",{className:_().acc_form_row,children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"Email"}),(0,i.jsx)("div",{className:_().acc_form_row_ip,children:(0,i.jsx)("input",{...E("email"),disabled:!0,type:"text",className:"app-input"})})]}),(0,i.jsxs)("div",{className:_().acc_form_row,children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"Số điện thoại"}),(0,i.jsxs)("div",{className:_().acc_form_row_ip,children:[(0,i.jsx)("input",{...E("telephone"),type:"text",className:"app-input"}),(0,i.jsx)("span",{className:_().acc_form_row_ip_error,children:null==T?void 0:null===(l=T.telephone)||void 0===l?void 0:l.message})]})]}),(0,i.jsxs)("div",{className:_().acc_form_row,children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"M\xe3 CCCD"}),(0,i.jsx)("div",{className:_().acc_form_row_ip,children:(0,i.jsx)("input",{...E("ccid"),type:"text",className:"app-input"})})]}),(0,i.jsxs)("div",{className:_().acc_form_row,children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"Địa chỉ"}),(0,i.jsxs)("div",{className:_().acc_form_row_ip,children:[(0,i.jsx)("input",{...E("full_address"),type:"text",className:"app-input"}),(0,i.jsx)("span",{className:_().acc_form_row_ip_error,children:null==T?void 0:null===(n=T.full_address)||void 0===n?void 0:n.message})]})]}),(0,i.jsxs)("div",{className:_().acc_form_row,children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"Giới t\xednh"}),(0,i.jsx)("div",{className:_().acc_form_row_ip,children:(0,i.jsxs)(m.Z,{row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"row-radio-buttons-group",onChange:H,value:M,children:[(0,i.jsx)(u.Z,{value:!0,control:(0,i.jsx)(h.Z,{style:{color:"var(--primary)"}}),label:"Nam"}),(0,i.jsx)(u.Z,{value:!1,control:(0,i.jsx)(h.Z,{style:{color:"var(--primary)"}}),label:"Nữ"})]})})]}),(0,i.jsxs)("div",{className:_().acc_form_row,children:[(0,i.jsx)("label",{className:_().acc_form_row_label,children:"Ng\xe0y sinh"}),(0,i.jsx)("div",{className:_().acc_form_row_ip,children:(0,i.jsx)(v.M,{value:F,disableFuture:!0,onChange:e=>P(e)})})]}),(0,i.jsx)("div",{className:_().acc_form_bot,children:(0,i.jsx)(d.Z,{style:{backgroundColor:"var(--primary)"},variant:"contained",size:"large",type:"submit",loading:I,children:"Lưu thay đổi"})})]})]})}},26394:function(e){e.exports={account_page_title:"account_account_page_title__cFga2",account_page_body:"account_account_page_body__Fsv84",acc_form_row:"account_acc_form_row__lIrx_",acc_form_row_label:"account_acc_form_row_label__vcEod",acc_form_row_ip:"account_acc_form_row_ip__qR_vq",acc_form_row_ip_error:"account_acc_form_row_ip_error__XacFg",acc_form_bot:"account_acc_form_bot__M4cAl",row_avatar:"account_row_avatar__ge_Na",form_avatar:"account_form_avatar__tTEgY",form_avatar_btn:"account_form_avatar_btn__qwwkH",booking_item:"account_booking_item__oALVH",booking_item_detail:"account_booking_item_detail__reDxw",booking_item_detail_head:"account_booking_item_detail_head__Dc_An",booking_item_detail_amount:"account_booking_item_detail_amount__hPeZT",booking_item_img:"account_booking_item_img__hSbjz",booking_item_detail_head_create:"account_booking_item_detail_head_create__0_9rt",booking_item_detail_address:"account_booking_item_detail_address__kKbUr",range_date:"account_range_date__C1LDC",range_date_item:"account_range_date_item__jRXps",account_page_bot:"account_account_page_bot__NIbYI",booking_list_item:"account_booking_list_item__QiWar"}}},function(e){e.O(0,[885,912,828,491,445,797,774,888,179],function(){return e(e.s=97971)}),_N_E=e.O()}]);